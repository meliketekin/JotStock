{"version":3,"file":"Cordova.js","sourceRoot":"","sources":["../../../../lib/Steps/Integrations/Cordova.ts"],"names":[],"mappings":"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","sourcesContent":["import * as fs from 'fs';\nimport { Answers } from 'inquirer';\nimport * as path from 'path';\n\nimport { Args } from '../../Constants';\nimport { exists, matchesContent, patchMatchingFile } from '../../Helper/File';\nimport { green } from '../../Helper/Logging';\nimport { SentryCli } from '../../Helper/SentryCli';\nimport { BaseIntegration } from './BaseIntegration';\n\nconst xcode = require('xcode');\n\nexport class Cordova extends BaseIntegration {\n  protected _sentryCli: SentryCli;\n  protected _folderPrefix: string = 'platforms';\n  protected _pluginFolder: string[] = ['.'];\n\n  constructor(protected _argv: Args) {\n    super(_argv);\n    this._sentryCli = new SentryCli(this._argv);\n  }\n\n  public async emit(answers: Answers): Promise<Answers> {\n    if (this._argv.uninstall) {\n      return this.uninstall(answers);\n    }\n\n    const sentryCliProperties = this._sentryCli.convertAnswersToProperties(\n      answers,\n    );\n\n    await patchMatchingFile(\n      `${this._folderPrefix}/ios/*.xcodeproj/project.pbxproj`,\n      this._patchXcodeProj.bind(this),\n    );\n\n    await this._addSentryProperties(sentryCliProperties);\n    green(`Successfully set up for cordova`);\n\n    return {};\n  }\n\n  public async uninstall(_answers: Answers): Promise<Answers> {\n    await patchMatchingFile(\n      '**/*.xcodeproj/project.pbxproj',\n      this._unpatchXcodeProj.bind(this),\n    );\n\n    return {};\n  }\n\n  public async shouldConfigure(_answers: Answers): Promise<Answers> {\n    if (this._shouldConfigure) {\n      return this._shouldConfigure;\n    }\n\n    let result = false;\n    if (!exists(path.join('sentry.properties'))) {\n      result = true;\n      this.debug(`sentry.properties not exists`);\n    }\n\n    if (\n      !matchesContent('**/*.xcodeproj/project.pbxproj', /SENTRY_PROPERTIES/gi)\n    ) {\n      result = true;\n      this.debug('**/*.xcodeproj/project.pbxproj not matched');\n    }\n\n    if (this._argv.uninstall) {\n      // if we uninstall we need to invert the result so we remove already patched\n      result = !result;\n    }\n\n    this._shouldConfigure = Promise.resolve({ cordova: result });\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    return this.shouldConfigure;\n  }\n\n  private _unpatchXcodeProj(filename: string): Promise<string> {\n    const proj = xcode.project(filename);\n    return new Promise((resolve, reject) => {\n      proj.parse((err: any) => {\n        if (err) {\n          reject(err);\n          return;\n        }\n\n        this._unpatchXcodeBuildScripts(proj);\n        resolve(proj.writeSync());\n      });\n    });\n  }\n\n  private _unpatchXcodeBuildScripts(proj: any): void {\n    const scripts = proj.hash.project.objects.PBXShellScriptBuildPhase || {};\n    const firstTarget = proj.getFirstTarget().uuid;\n    const nativeTargets = proj.hash.project.objects.PBXNativeTarget;\n\n    // scripts to kill entirely.\n    for (const key of Object.keys(scripts)) {\n      const script = scripts[key];\n\n      // ignore comments and keys that got deleted\n      if (typeof script === 'string' || script === undefined) {\n        continue;\n      }\n\n      if (\n        script.shellScript.match(/SENTRY_PROPERTIES/) ||\n        script.shellScript.match(/SENTRY_FRAMEWORK_PATCH/)\n      ) {\n        // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n        delete scripts[key];\n        // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n        delete scripts[`${key}_comment`];\n        const phases = nativeTargets[firstTarget].buildPhases;\n        if (phases) {\n          for (let i = 0; i < phases.length; i++) {\n            if (phases[i].value === key) {\n              phases.splice(i, 1);\n              break;\n            }\n          }\n        }\n        continue;\n      }\n    }\n  }\n\n  private _patchXcodeProj(\n    contents: string,\n    filename: string,\n  ): Promise<void | string> {\n    const proj = xcode.project(filename);\n    return new Promise((resolve, reject) => {\n      proj.parse((err: any) => {\n        if (err) {\n          reject(err);\n          return;\n        }\n\n        const buildScripts = [];\n        for (const key in proj.hash.project.objects.PBXShellScriptBuildPhase ||\n          {}) {\n          if (\n            // eslint-disable-next-line no-prototype-builtins\n            proj.hash.project.objects.PBXShellScriptBuildPhase.hasOwnProperty(\n              key,\n            )\n          ) {\n            const val = proj.hash.project.objects.PBXShellScriptBuildPhase[key];\n            if (val.isa) {\n              buildScripts.push(val);\n            }\n          }\n        }\n\n        this._addNewXcodeBuildPhaseForSymbols(buildScripts, proj);\n        this._addNewXcodeBuildPhaseForStripping(buildScripts, proj);\n\n        // we always modify the xcode file in memory but we only want to save it\n        // in case the user wants configuration for ios.  This is why we check\n        // here first if changes are made before we might prompt the platform\n        // continue prompt.\n        const newContents = proj.writeSync();\n        if (newContents === contents) {\n          resolve();\n        } else {\n          resolve(newContents);\n        }\n      });\n    });\n  }\n\n  private _addNewXcodeBuildPhaseForSymbols(buildScripts: any, proj: any): void {\n    for (const script of buildScripts) {\n      if (script.shellScript.match(/SENTRY_PROPERTIES/)) {\n        return;\n      }\n    }\n    const cwd = path.join(process.cwd(), 'sentry.properties');\n    proj.addBuildPhase(\n      [],\n      'PBXShellScriptBuildPhase',\n      'Upload Debug Symbols to Sentry',\n      null,\n      {\n        shellPath: '/bin/sh',\n        shellScript:\n          // eslint-disable-next-line prefer-template\n          'echo \"warning: uploading debug symbols - set SENTRY_SKIP_DSYM_UPLOAD=true to skip this\"\\\\n' +\n          'if [ -n \"$SENTRY_SKIP_DSYM_UPLOAD\" ]; then\\\\n' +\n          '  echo \"warning: skipping debug symbol upload\"\\\\n' +\n          '  exit 0\\\\n' +\n          'fi\\\\n' +\n          'export SENTRY_PROPERTIES=' +\n          cwd +\n          '\\\\n' +\n          'function getProperty {\\\\n' +\n          '    PROP_KEY=$1\\\\n' +\n          '    PROP_VALUE=`cat $SENTRY_PROPERTIES | grep \"$PROP_KEY\" | cut -d\\'=\\' -f2`\\\\n' +\n          '    echo $PROP_VALUE\\\\n' +\n          '}\\\\n' +\n          'if [ ! -f $SENTRY_PROPERTIES ]; then\\\\n' +\n          '  echo \"warning: SENTRY: sentry.properties file not found! Skipping symbol upload.\"\\\\n' +\n          '  exit 0\\\\n' +\n          'fi\\\\n' +\n          'echo \"# Reading property from $SENTRY_PROPERTIES\"\\\\n' +\n          'SENTRY_CLI=$(getProperty \"cli.executable\")\\\\n' +\n          'SENTRY_COMMAND=\"../../$SENTRY_CLI upload-dsym\"\\\\n' +\n          '$SENTRY_COMMAND',\n      },\n    );\n  }\n\n  private _addNewXcodeBuildPhaseForStripping(\n    buildScripts: any,\n    proj: any,\n  ): void {\n    for (const script of buildScripts) {\n      if (script.shellScript.match(/SENTRY_FRAMEWORK_PATCH/)) {\n        return;\n      }\n    }\n    // http://ikennd.ac/blog/2015/02/stripping-unwanted-architectures-from-dynamic-libraries-in-xcode/\n    proj.addBuildPhase(\n      [],\n      'PBXShellScriptBuildPhase',\n      'Sentry strip unused archs from Framework',\n      null,\n      {\n        shellPath: '/bin/sh',\n        shellScript:\n          '# SENTRY_FRAMEWORK_PATCH \\\\n' +\n          'echo \"warning: patching framework - set SENTRY_SKIP_FRAMEWORK_PATCH=true to skip this\"\\\\n' +\n          'if [ -n \"$SENTRY_SKIP_FRAMEWORK_PATCH\" ]; then\\\\n' +\n          '  echo \"warning: skipping framework patch\"\\\\n' +\n          '  exit 0\\\\n' +\n          'fi\\\\n' +\n          'APP_PATH=\"${TARGET_BUILD_DIR}/${WRAPPER_NAME}\"\\\\n' +\n          'find \"$APP_PATH\" -name \\'Sentry*.framework\\' -type d | while read -r FRAMEWORK\\\\n' +\n          'do\\\\n' +\n          'FRAMEWORK_EXECUTABLE_NAME=$(defaults read \"$FRAMEWORK/Info.plist\" CFBundleExecutable)\\\\n' +\n          'FRAMEWORK_EXECUTABLE_PATH=\"$FRAMEWORK/$FRAMEWORK_EXECUTABLE_NAME\"\\\\n' +\n          'echo \"Executable is $FRAMEWORK_EXECUTABLE_PATH\"\\\\n' +\n          'EXTRACTED_ARCHS=()\\\\n' +\n          'for ARCH in $ARCHS\\\\n' +\n          'do\\\\n' +\n          'echo \"Extracting $ARCH from $FRAMEWORK_EXECUTABLE_NAME\"\\\\n' +\n          'lipo -extract \"$ARCH\" \"$FRAMEWORK_EXECUTABLE_PATH\" -o \"$FRAMEWORK_EXECUTABLE_PATH-$ARCH\"\\\\n' +\n          'EXTRACTED_ARCHS+=(\"$FRAMEWORK_EXECUTABLE_PATH-$ARCH\")\\\\n' +\n          'done\\\\n' +\n          'echo \"Merging extracted architectures: ${ARCHS}\"\\\\n' +\n          'lipo -o \"$FRAMEWORK_EXECUTABLE_PATH-merged\" -create \"${EXTRACTED_ARCHS[@]}\"\\\\n' +\n          'rm \"${EXTRACTED_ARCHS[@]}\"\\\\n' +\n          'echo \"Replacing original executable with thinned version\"\\\\n' +\n          'rm \"$FRAMEWORK_EXECUTABLE_PATH\"\\\\n' +\n          'mv \"$FRAMEWORK_EXECUTABLE_PATH-merged\" \"$FRAMEWORK_EXECUTABLE_PATH\"\\\\n' +\n          'done',\n      },\n    );\n  }\n\n  private _addSentryProperties(properties: any): Promise<void> {\n    let rv = Promise.resolve();\n    const fn = path.join('sentry.properties');\n    if (exists(fn)) {\n      return rv;\n    }\n    rv = rv.then(() =>\n      fs.writeFileSync(fn, this._sentryCli.dumpProperties(properties)),\n    );\n\n    return rv;\n  }\n}\n"]}